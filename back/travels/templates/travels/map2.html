<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Kakao 지도 시작하기</title>
</head>
<body>
	<div id="map" style="width:500px;height:400px;"></div>
	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey={{KAKAO_API_KEY}}&libraries=services"></script>
	<script type="text/javascript">
    // 주소-좌표 변환 객체를 생성합니다

    var geocoder = new kakao.maps.services.Geocoder();

    function searchAddrFromCoords(lon, lat, callback) {
        // 좌표로 행정동 주소 정보를 요청합니다
        geocoder.coord2RegionCode(lon, lat, callback);         
    }

    function searchDetailAddrFromCoords(lon, lat, callback) {
        // 좌표로 법정동 상세 주소 정보를 요청합니다
        geocoder.coord2Address(lon, lat, callback);
    }
    if (navigator.geolocation) {
        // GeoLocation을 이용해서 접속 위치를 얻어옵니다
        navigator.geolocation.getCurrentPosition(function(position) {
            
            var lat = position.coords.latitude, // 위도
                lon = position.coords.longitude; // 경도
            console.log(lat, lon)
            searchDetailAddrFromCoords(lon, lat, function(res) {
              var addr = res[0].address.address_name
              console.log(addr)
              var url = "https://map.kakao.com/?map_type=TYPE_MAP&target=walk&rt=%2C%2C523953%2C1084098&rt1="+addr+"&rt2=s&rtIds=%2C&rtTypes=%2C"
              console.log(url)
            })
            
                
          });
        
    } else { // HTML5의 GeoLocation을 사용할 수 없을때 마커 표시 위치와 인포윈도우 내용을 설정합니다
            message = 'geolocation을 사용할수 없어요..'
        displayMarker(locPosition, message);
    }

    //  function displayMarker(locPosition, message) {

    //     // 마커를 생성합니다
    //     var marker = new kakao.maps.Marker({  
    //         map: map, 
    //         position: locPosition
    //     }); 
        
    //     var iwContent = message, // 인포윈도우에 표시할 내용
    //         iwRemoveable = true;

    //     // 인포윈도우를 생성합니다
    //     var infowindow = new kakao.maps.InfoWindow({
    //         content : iwContent,
    //         removable : iwRemoveable
    //     });
        
    //     // 인포윈도우를 마커위에 표시합니다 
    //     infowindow.open(map, marker);
        
    //     // 지도 중심좌표를 접속위치로 변경합니다
    //     map.setCenter(locPosition);      
    // }
	</script>
</body>
</html>